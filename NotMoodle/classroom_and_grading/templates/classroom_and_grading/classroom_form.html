{% extends 'base.html' %}
{% load static %}

{% block title %}{% if object %}Edit{% else %}Create{% endif %} Classroom • NotMoodle{% endblock %}

{% block nav_auth %}
<div class="nav-auth">
  <a class="login" href="#">Hello, {{ request.user.get_full_name|default:request.user.username }}</a>
  <a class="signup" href="{% url 'teachersManagement:teacher_home' %}">Dashboard</a>
  <a class="login" href="{% url 'teachersManagement:teacher_logout' %}">Logout</a>
</div>
{% endblock %}

{% block head_extra %}
  <link rel="stylesheet" href="{% static 'css/lesson_form.css' %}">
  <style>
    /* Background (same vibe as lesson form) */
    .blurred-background{
      position: fixed; inset: 0; width: 100%; height: 100%;
      object-fit: cover; filter: blur(12px) brightness(.98);
      transform: scale(1.06); z-index: -1;
    }

    /* Page shell */
    .lf-shell { max-width: 1100px; margin: 0 auto; padding: 8px 0 32px; }

    /* Glassy containers & header */
    .glass-card{
      background: rgba(255,255,255,.28);
      border: 1px solid rgba(255,255,255,.35);
      box-shadow: 0 12px 30px rgba(0,0,0,.12);
      backdrop-filter: blur(10px);
      border-radius: 14px;
    }
    .page-header{
      display:flex; align-items:center; gap:12px; margin-bottom: 14px;
      padding: 12px 16px;
    }
    .page-header .title{
      margin: 0; font-size: 1.6rem; font-weight: 800; color:#fff;
      text-shadow: 0 1px 3px rgba(0,0,0,.18);
    }

    /* Buttons – translucent like lesson form */
    .btn{
      display:inline-flex; align-items:center; gap:8px; cursor:pointer;
      padding:10px 14px; border-radius: 10px; font-weight: 700;
      text-decoration:none; transition: all .18s ease; border: 1px solid transparent;
      backdrop-filter: blur(8px);
    }
    .btn-glass{
      background: rgba(255,255,255,.16); color:#fff; border-color: rgba(255,255,255,.28);
      box-shadow: 0 8px 18px rgba(0,0,0,.12);
    }
    .btn-glass:hover{ background: rgba(255,255,255,.22); transform: translateY(-1px); }
    .btn-primary{
      background: rgba(118, 147, 218, 1); color:#fff; border-color: rgba(118, 147, 218, 1);
      box-shadow: 0 8px 18px rgba(45,108,223,.28);
    }
    .btn-primary:hover{ filter: brightness(.96); transform: translateY(-1px); }
    .btn-ghost{
      background: rgba(255,255,255,.14); color:#111827; border-color: rgba(255,255,255,.28);
    }

    /* Card that wraps the form */
    .lf-card.glassy { padding: 18px; }

    /* Form styling to match lesson form */
    .lf-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .lf-label {
      display: block;
      font-weight: 600;
      color: #374151;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }

    .lf-help {
      font-size: 0.8rem;
      color: #6b7280;
      margin-top: 0.25rem;
      margin-bottom: 0.5rem;
    }

    input[type="text"], input[type="datetime-local"], select, textarea {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      background: rgba(255,255,255,.8);
      font-size: 0.9rem;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    input[type="text"]:focus, input[type="datetime-local"]:focus, select:focus, textarea:focus {
      outline: none;
      border-color: rgba(118, 147, 218, 0.5);
      box-shadow: 0 0 0 3px rgba(118, 147, 218, 0.1);
    }

    .errorlist {
      color: #dc2626;
      font-size: 0.8rem;
      margin-top: 0.25rem;
      list-style: none;
      padding: 0;
    }

    .lf-actions {
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      margin-top: 2rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(255,255,255,.2);
    }
  </style>
{% endblock %}

{% block content %}
  <!-- Blurred background -->
  <img class="blurred-background" src="{% static 'img/grading_page_bg.jpg' %}" alt="">

  <div class="lf-shell">
    <header class="page-header glass-card">
      <h1 class="title">
        {% if object %}Edit{% else %}Create{% endif %} Classroom
      </h1>
      <div style="margin-left:auto; display:flex; gap:10px;">
        <a class="btn btn-primary" href="{% url 'classroom_and_grading:classroom_list' %}">All Classrooms</a>
      </div>
    </header>

    <form method="post" class="lf-card glass-card glassy">
      {% csrf_token %}
      {{ form.non_field_errors }}

      <div class="lf-row">
        <div>
          <label class="lf-label">{{ form.course.label }}</label>
          {{ form.course.errors }}
          {{ form.course }}
        </div>
        <div>
          <label class="lf-label">{{ form.lesson.label }}</label>
          {{ form.lesson.errors }}
          {{ form.lesson }}
        </div>
      </div>

      <div class="lf-row">
        <div>
          <label class="lf-label">Start Date</label>
          {{ form.start_date.errors }}
          {{ form.start_date }}
          <div class="lf-help">Choose a unique start time to avoid conflicts with existing classrooms.</div>
        </div>
        <div>
          <label class="lf-label">End Date</label>
          {{ form.end_date.errors }}
          {{ form.end_date }}
        </div>
      </div>

      {% if messages %}
        <div style="margin: 1rem 0;">
          {% for message in messages %}
            <div style="padding: 0.75rem; border-radius: 0.5rem; 
                        {% if message.tags == 'error' %}background: #fef2f2; color: #dc2626; border: 1px solid #fecaca;
                        {% elif message.tags == 'success' %}background: #f0fdf4; color: #166534; border: 1px solid #bbf7d0;
                        {% else %}background: #f8fafc; color: #475569; border: 1px solid #e2e8f0;{% endif %}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}

      <div class="lf-actions">
        <a class="btn btn-glass" href="{% url 'classroom_and_grading:classroom_list' %}">Cancel</a>
        <button type="submit" class="btn btn-primary">{% if object %}Update{% else %}Create{% endif %} Classroom</button>
      </div>
    </form>
  </div>
{% endblock %}
